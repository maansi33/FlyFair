<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FlyFair - Flight Checker</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f0f4f8;
            padding: 20px;
            text-align: center;
        }
        h1 { color: #2c3e50; }
        label { margin: 10px; display: inline-block; }
        input { padding: 5px; font-size: 16px; }
        button {
            padding: 8px 15px;
            font-size: 16px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover { background-color: #2980b9; }
        table { width: 100%; margin-top: 20px; border-collapse: collapse; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
        th { background-color: #3498db; color: white; }
        tr:nth-child(even) { background-color: #ecf0f1; }
        @media(max-width: 600px) {
            table, thead, tbody, th, td, tr { display: block; }
            tr { margin-bottom: 15px; }
            th { display: none; }
            td { text-align: right; padding-left: 50%; position: relative; }
            td::before {
                content: attr(data-label);
                position: absolute;
                left: 0;
                width: 50%;
                padding-left: 10px;
                font-weight: bold;
                text-align: left;
            }
        }
    </style>
</head>
<body>
    <h1>FlyFair</h1>
    <p>Check flight prices easily!</p>

    <label>Origin: <input type="text" id="origin" placeholder="DEL"></label>
    <label>Destination: <input type="text" id="destination" placeholder="KTM"></label>
    <label>Date: <input type="date" id="date"></label>
    <label>Target Price (USD): <input type="number" id="targetPrice" placeholder="90"></label>
    <label>Email: <input type="email" id="email" placeholder="example@gmail.com"></label>
    <button onclick="checkFlights()">Check Prices</button>

    <table id="results">
        <thead>
            <tr>
                <th>Airline</th>
                <th>Flight Number</th>
                <th>Departure</th>
                <th>Arrival</th>
                <th>Duration</th>
                <th>Price</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    <script>
        async function checkFlights() {
            const origin = document.getElementById('origin').value;
            const destination = document.getElementById('destination').value;
            const date = document.getElementById('date').value;
            const targetPrice = document.getElementById('targetPrice').value;
            const email = document.getElementById('email').value;

            try {
                const res = await fetch('https://upset-planes-draw.loca.lt/check-price?origin=DEL&destination=KTM&date=2025-08-15&targetPrice=100&email=example@gmail.com')
                ;


                if (!res.ok) throw new Error(`HTTP error! status: ${res.status}`);
                const data = await res.json();

                const tbody = document.querySelector('#results tbody');
                tbody.innerHTML = '';

                data.forEach(flight => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td data-label="Airline">${flight.airline}</td>
                        <td data-label="Flight Number">${flight.flight_number}</td>
                        <td data-label="Departure">${flight.departure}</td>
                        <td data-label="Arrival">${flight.arrival}</td>
                        <td data-label="Duration">${flight.duration}</td>
                        <td data-label="Price">${flight.price} ${flight.currency}</td>
                    `;
                    tbody.appendChild(row);

                    // Optional: show alert in browser if price is below target
                    if (targetPrice && parseFloat(flight.price) <= parseFloat(targetPrice)) {
                        alert(`ðŸŽ‰ Price Drop! ${flight.airline} ${flight.flight_number} is now $${flight.price}`);
                    }
                });
            } catch (err) {
                console.error(err);
                alert("Error fetching flight data");
            }
        }
    </script>
</body>
</html>
